<!DOCTYPE html>
<html>
<head>
    <title>svg3D标签云</title>
    <script src="http://cdn.bootcss.com/vue/2.2.0/vue.min.js"></script>
</head>
<body>
    <div id='app'>
        <svg :width='width' :height='height'>
            <a :href="tag.href" v-for='tag in tags'>
                <text :x='tag.y' :y='tag.x' :font-size='20 * (600/(600-tag.z))'>{{tag.text}}</text>
            </a>
        </svg>
    </div>
    <script>
        var app = new Vue({
            el: '#app',
            data: {
                width:700,
                height:700,
                tagsNum:20,
                tags: [{
                    text:'js',
                    href:'/js',
                    x:20,
                    y:20
                },{
                    text:'css',
                    href:'/css',
                    x:40,
                    y:40
                },{
                    text:'html',
                    href:'/html',
                    x:60,
                    y:60
                }]
            },
            computed:{
                CX(){
                    return this.width/2;
                },
                CY(){
                    return this.height/2;
                }
            },
            created(){
                let tags=[],RADIUS= 200;
                console.log(this.tagsNum)
                for(let i=0;i<this.tagsNum;i++){
                    let tag={};
                    let k = -1+(2*(i+1)-1)/this.tagsNum;
                    let a = Math.acos(k);
                    let b = a*Math.sqrt(this.tagsNum*Math.PI)
                    tag.text = i + 'tag';
                    tag.x = this.CX +  RADIUS * Math.sin(a) * Math.cos(b);
                    tag.y = this.CY +  RADIUS * Math.sin(a) * Math.sin(b); 
                    tag.z = RADIUS * Math.cos(a);
                    tags.push(tag)
                }
                console.log(tags)
                this.tags = tags;
            },
            mounted(){
                var angle=0;
                setInterval(()=>{
                    angle = Math.PI/300;
                    this.rotateX(angle);
                },17)
            },
            methods:{
                rotateX(angleX){
                        var cos = Math.cos(angleX);
                        var sin = Math.sin(angleX);
                        for(let tag of this.tags){
                            var y1 = (tag.y- this.CY) * cos - tag.z * sin  + this.CY;
                            var z1 = tag.z * cos + (tag.y- this.CY) * sin;
                            tag.y = y1;
                            tag.z = z1;
                        } 
                },
                rotateY(angleY){
                        var cos = Math.cos(angleY);
                        var sin = Math.sin(angleY);
                        for(let tag of this.tags){
                            var x1 = (tag.x-this.CX) * cos - tag.z * sin +CX;
				            var z1 = tag.z * cos + (tag.x-this.CX) * sin;
                            tag.x = x1;
                            tag.z = z1;
                        } 
                    }
                }
            })

/*
        var paper = document.querySelector("svg");//svg
            tags = document.querySelectorAll('svg text');
            FONTSIZE = 20;
            RADIUS =300,
            fallLength = 600,//焦距
            tagArr=[],
            angleX = Math.PI/300,
            angleY = Math.PI/300,
            CX = paper.getAttribute('width')/2,//球心坐标
            CY = paper.getAttribute('height')/2;//球心坐标
        
        function Ball(x,y,r){
            this.cx = x;
            this.cy = y;
            this.r = r;
            this.el = el;
        }
        Ball.prototype.rotateX = function(){

        }
        Ball.prototype.rotateY = function(){

        }
        Ball.prototype.init = function(){

        }

        function Tag(ele , x , y , z){
            this.ele = ele;
            this.x = x;
            this.y = y;
            this.z = z;
        }
        function init(){
            var len = tags.length
            for(var i=0;i<len;i++){
                var k = -1+(2*(i+1)-1)/len;
                var a = Math.acos(k);
                var b = a*Math.sqrt(len*Math.PI);
                // var a = Math.random()*2*Math.PI;
                // var b = Math.random()*2*Math.PI;
                var x =CX +  RADIUS * Math.sin(a) * Math.cos(b);
                var y =CY +  RADIUS * Math.sin(a) * Math.sin(b); 
                var z = RADIUS * Math.cos(a);
                var t = new Tag(tags[i] , x , y , z);
                tags[i].setAttribute('x',x);
                tags[i].setAttribute('y',y);
                tags[i].setAttribute('font-size', FONTSIZE * (fallLength/(fallLength-this.z)));
                tags[i].setAttribute('fill', "rgb("+parseInt(Math.random()*255)+","+parseInt(Math.random()*255)+","+parseInt(Math.random()*255)+")")
                tagArr.push(t);
            }
        }
        Array.prototype.forEach = function(callback){
			for(var i=0;i<this.length;i++){
				callback.call(this[i]);
			}
		}
        function animate(){
			setInterval(function(){
                angleY += Math.PI/300;
                angleY = angleX>Math.PI? 0 : angleX
				rotateX();
				//rotateY();
			} , 17);
		}
        function rotateX(){
			var cos = Math.cos(angleX);
			var sin = Math.sin(angleX);
			tagArr.forEach(function(){
				var y1 = (this.y-CY) * cos - this.z * sin  +CY;
				var z1 = this.z * cos + (this.y-CY) * sin;
				this.y = y1;
				this.z = z1;
                this.ele.setAttribute('y',this.y)
                this.ele.setAttribute('font-size', FONTSIZE * (fallLength/(fallLength-this.z)));
			})
			
		}
        function rotateY(){
			var cos = Math.cos(angleY);
			var sin = Math.sin(angleY);
			tagArr.forEach(function(){
				var x1 = (this.x-CX) * cos - this.z * sin +CX;
				var z1 = this.z * cos + (this.x-CX) * sin;
				this.x = x1;
				this.z = z1;
                this.ele.setAttribute('x',this.x)
                this.ele.setAttribute('font-size', FONTSIZE * (fallLength/(fallLength-this.z)));
			})
		}
        init();
        animate();
*/
    </script>
</body>
</html>