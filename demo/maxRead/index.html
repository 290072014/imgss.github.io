<html>
<head>
    <title>博客园阅读量</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="stylesheet" href="/stylesheets/bootstrap.min.css">
    <script src="/jslib/jquery-3.1.0.min.js"></script>
    <script src="./jet.min.js"></script>

</head>
<body class="container">
    <h1>博客园抓取的文章3000篇</h1>
    <form class="form-group row">
    <input type='search' id='search' class="form-control" placeholder="搜一下"/>
    </form>
    <table class='table-striped table .table-hover' id='table'
               data-toggle="table"
               data-classes="table table-no-bordered"
               data-height="460"
               data-url="./merge.json"
               data-sort-name="name"
               data-sort-order="desc">
        <thead>
            <tr>
                <th data-field="user">
                    用户名
                </th>
                <th data-field="article" data-sortable="true">
                    文章名称       
                </th>
                <th data-field="maxReadNo" data-sortable="true">
                    阅读数
                </th>
                <th data-field="age" data-sortable="true">
                    园龄
                </th>
                <th data-field="follower" data-sortable="true">
                    粉丝数
                </th>
            </tr>
        </thead>
        <tbody id="jetsContent">

        </tbody>
    </table>
</body>
<script>
var userData;

function genTable(data){
    console.log(data.length);
    var body='';
    for(var i=0;i<3000;i++){
        var item=data[i];
        body+=`<tr>
                <td>${item.user || '-'}</td>
                <td><a  href="${item.maxReadUrl}">${item.article || '-'}</a></td>
                <td>${item.maxReadNo}</td>
                <td>${item.age || '-'}</td>
                <td>${item.follower || '-'}</td>
              </tr>`;
    }
    $('tbody').html(body);
    var jets = new Jets({
        searchTag: '#search',
        contentTag: '#jetsContent',
        columns: [1]
    });
}

$.get('./merge.json',function(result){
    userData = result;
    genTable(result);
});

function sort(field){
  return  userData.sort(function(a,b){
        return b[field]-a[field];
    })
}

$('tr').on('click','th',function(event){
    console.log(event.target);
    var field = event.target.dataset.field;
    console.log(field);
    genTable(sort(field));
})
</script>
</html>